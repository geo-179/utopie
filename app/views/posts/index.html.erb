<%# BACKGROUND IMAGE wraps entire index %>
<div class="pb-5">


  <%# SEARCH BAR FOR FILTERING %>
  <div class="d-flex w-100 justify-content-evenly align-items-center double-border px-4 py-2 searchbar-gradient mb-5">
    <form action="posts" method="get">
      <label for="keyword" class="label-text searchbar-text">Search Posts by Keyword</label>
      <input type="text" name="keyword" id="keyword" class="ms-1">
      <label for="category" class="label-text ms-5 searchbar-text">Category</label>
      <select name="category" id="category" class="ms-1">
        <% case params[:category] %>
        <% when "3D Modeling" %>
          <option value="3D Modeling" selected="selected">3D Modeling</option>
          <option value="2D Visual Art">2D Visual Art</option>
          <option value="Music Tech">Music Tech</option>
        <% when "2D Visual Art" %>
          <option value="3D Modeling">3D Modeling</option>
          <option value="2D Visual Art" selected="selected">2D Visual Art</option>
          <option value="Music Tech">Music Tech</option>
        <% else %>
          <option value="3D Modeling">3D Modeling</option>
          <option value="2D Visual Art">2D Visual Art</option>
          <option value="Music Tech" selected="selected">Music Tech</option>
        <% end %>
      </select>
      <input type="submit" value="Search" class="button-33 ms-5">
    </form>
    <%# CREATE NEW POST %>
    <div class="d-flex justify-content-center">
      <%= link_to new_post_path do %>
        <button class="button-36" type="button fw-medium">Create New Post</button>
      <% end %>
    </div>
  </div>



  <%# CARDS AND MODAL FOR POST %>



  <div class="container py-5">
    <div class="row" data-masonry='{"percentposition": true }'>

    <%# Image Card %>
    <% @posts.each do |post| %>
      <div class="col-sm-6 col-lg-4 mb-4" data-controller="post-subscription" data-post-subscription-post-id-value="<%= post.id %>" data-post-subscription-target="comments" data-post-subscription-target="likes" data-post-subscription-user-id-value='<%= current_user.id %>'>

        <%# CARD %>
        <div class="cd">
          <div class="relative">
            <%= cl_image_tag post.photos[0].key, crop: :fill, class: "d-block w-100 card-img-top", alt: "collage" %>
          </div>



          <%# CARD BODY THAT MOVES IN %>
          <div class="cd-body">
            <h1 class="cd-title"><%= post.title %></h1>
            <h2 class="cd-author">By: <%= post.user.nickname %></h2>


            <%# POST AND LIKE %>
            <div class="d-flex">
              <button type="button" class="cd-button" data-bs-toggle="modal" data-bs-target="#post-<%= post.id%>-modal">
                View Post
              </button>

              <div class="flex-grow-1"></div>
            </div>


          </div>

          <div class="top-corner d-flex align-items-center py-1 px-2">
            <%# HEART AND LIKE %>
            <div data-post-subscription-target="likes">
              <%= render "likes/like", post: post %>
            </div>

            <div data-post-subscription-target="button" data-post-subscription-user-id-value="<%= current_user.id %>">
              <%= render "likes/like_button", post: post %>
            </div>
          </div>
        </div>


        <%# **** %>
        <%= render "partials/post_modal", post: post %>
      </div>
    <% end %>

    </div>
  </div>

</div>
