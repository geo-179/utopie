<%# BACKGROUND IMAGE wraps entire index %>
<div style="height: 100vh; background-color:white;">
  <div class="pb-5">

    <div class="d-flex w-100 justify-content-evenly align-items-center mb-30" style="padding-top: 120px">
      <%# CREATE NEW POST %>
      <div>
      <%= link_to new_post_path do %>
        <button class="button-b" type="button fw-medium" style="text-decoration-none">Create New Post</button>
      <% end %>
      </div>
      <%# SEARCH BAR FOR FILTERING %>
      <form action="posts" method="get">
        <input type="text" name="keyword" id="keyword" class="ps-400 mr-100">
        <%# <label for="category" class="label-text ms-5 searchbar-text">Category</label> %>
        <select name="category" id="category" class="ms-5">
          <% case params[:category] %>
          <% when "3D Modeling" %>
            <option value="3D Modeling" selected="selected">3D Modeling</option>
            <option value="2D Visual Art">2D Visual Art</option>
            <option value="Music Tech">Music Tech</option>
          <% when "2D Visual Art" %>
            <option value="3D Modeling">3D Modeling</option>
            <option value="2D Visual Art" selected="selected">2D Visual Art</option>
            <option value="Music Tech">Music Tech</option>
          <% else %>
            <option value="3D Modeling">3D Modeling</option>
            <option value="2D Visual Art">2D Visual Art</option>
            <option value="Music Tech" selected="selected">Music Tech</option>
          <% end %>
        </select>
        <input type="submit" value="Search" class="button-b ms-5">
      </form>
    </div>

    <%# CARDS AND MODAL FOR POST %>

    <div class="container py-5">
      <div class="row" data-masonry='{"percentposition": true }'>

        <%# Image Card %>
        <% @posts.each do |post| %>
          <div class="col-sm-6 col-lg-4 mb-4" data-controller="post-subscription" data-post-subscription-post-id-value="<%= post.id %>" data-post-subscription-target="comments" data-post-subscription-target="likes" data-post-subscription-user-id-value='<%= current_user.id %>'>

            <%# CARD %>
            <div class="cd">
              <div class="relative">
                <%= cl_image_tag post.photos[0].key, crop: :fill, class: "d-block w-100 card-img-top", alt: "collage" %>
              </div>

              <%# **** %>
              <%= render "partials/post_modal", post: post %>

              <%# CARD BODY THAT MOVES IN %>
              <div class="cd-body">
                <h1 class="cd-title"><%= post.title %></h1>
                <h2 class="cd-author">By: <%= post.user.nickname %></h2>


                <%# POST AND LIKE %>
                <div class="d-flex">
                  <button type="button" class="cd-button" data-bs-toggle="modal" data-bs-target="#post-<%= post.id%>-modal">
                    View Post
                  </button>



                  <div class="flex-grow-1"></div>
                </div>


              </div>

              <div class="top-corner d-flex align-items-center py-1 px-2">
                <%# HEART AND LIKE %>
                <div data-post-subscription-target="likes">
                  <%= render "likes/like", post: post %>
                </div>

                <div data-post-subscription-target="button" data-post-subscription-user-id-value="<%= current_user.id %>">
                  <%= render "likes/like_button", post: post %>
                </div>
              </div>

            </div>
          </div>
        <% end %>

      </div>

    </div>

  </div>

</div>
